{"version":3,"sources":["pages/player.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["ChatBox","chats","sendMessage","name","useState","message","setMessage","id","className","style","maxHeight","map","chat","sender","wordBreak","time","Form","onSubmit","e","preventDefault","Control","value","onChange","target","placeholder","Button","disabled","type","Player","currSong","setCurrSong","isPlaying","setIsPlaying","loaded","setLoaded","currentState","setCurrentState","interacted","setInteracted","playerRef","useRef","setName","isNameModalOpen","setIsNameModalOpen","isChatModalOpen","setIsChatModalOpen","socket","setSocket","setChats","volume","setVolume","handleChatClick","useEffect","boxRef","document","getElementById","scrollTop","scrollHeight","emit","on","setInterval","currentlyPlaying","state","nextPlaying","currSongArg","currentSong","seek","Date","getTime","start","Math","abs","current","sync","song","io","onClick","play","Modal","show","centered","onHide","Header","Body","Group","v4","toLocaleString","src","url","ref","playing","onLoad","onPlay","onEnd","role","parseInt","step","min","max","length","slice","alt","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"yPAWA,SAASA,EAAT,GAAuH,IAArGC,EAAoG,EAApGA,MAAOC,EAA6F,EAA7FA,YAAaC,EAAgF,EAAhFA,KAClC,EAA8BC,mBAAS,IAAvC,mBAAOC,EAAP,KAAgBC,EAAhB,KACA,OAAO,gCACH,qBAAKC,GAAG,UAAUC,UAAU,yBAAyBC,MAAO,CAACC,UAAW,QAAxE,SACKT,EAAMU,KAAI,SAAAC,GAAI,OAAI,sBAAKJ,UAAW,SAAWI,EAAKC,SAAWV,EAAO,WAAa,cAA/D,UAEf,qBAAKM,MAAO,CAACK,UAAW,aAAxB,SAAuCF,EAAKP,UAC5C,wBAAOG,UAAU,WAAjB,UAA6BI,EAAKC,OAAlC,MAA6CD,EAAKG,QAClD,yBAHyBH,EAAKL,SAOtC,eAACS,EAAA,EAAD,CAAMC,SAAU,SAACC,GACbA,EAAEC,iBACW,KAAVd,IACHC,EAAW,IACXJ,EAAYG,KACbG,UAAU,SALb,UAMI,cAACQ,EAAA,EAAKI,QAAN,CAAcZ,UAAU,OAAOa,MAAOhB,EAASiB,SAAU,SAAAJ,GAAC,OAAIZ,EAAWY,EAAEK,OAAOF,QACpEG,YAAY,oBAC1B,cAACC,EAAA,EAAD,CAAQC,SAAoB,KAAVrB,EAAcsB,KAAK,SAArC,wBAOG,SAASC,IACpB,MAAgCxB,qBAAhC,mBAAOyB,EAAP,KAAiBC,EAAjB,KACA,EAAkC1B,oBAAS,GAA3C,mBAAO2B,EAAP,KAAkBC,EAAlB,KACA,EAA4B5B,oBAAS,GAArC,mBAAO6B,EAAP,KAAeC,EAAf,KACA,EAAwC9B,mBAA0B,KAAlE,mBAAO+B,EAAP,KAAqBC,EAArB,KACA,EAAoChC,oBAAS,GAA7C,mBAAOiC,EAAP,KAAmBC,EAAnB,KACMC,EAAiBC,iBAAO,MAC9B,EAAwBpC,mBAAiB,IAAzC,mBAAOD,EAAP,KAAasC,EAAb,KACA,EAA8CrC,oBAAS,GAAvD,mBAAOsC,EAAP,KAAwBC,EAAxB,KACA,EAA8CvC,oBAAS,GAAvD,mBAAOwC,EAAP,KAAwBC,EAAxB,KACA,EAA4BzC,qBAA5B,mBAAO0C,EAAP,KAAeC,EAAf,KACA,EAA0B3C,mBAAiB,IAA3C,mBAAOH,EAAP,KAAc+C,EAAd,KACA,EAAyB5C,mBAAS,KAAlC,mBAAO6C,EAAP,KAAcC,GAAd,KAsFA,SAASC,KACQ,KAAThD,GACA0C,GAAmB,GACnBF,GAAmB,KAEnBA,GAAmB,GACnBE,GAAmB,IAI3B,OA/FAO,qBAAU,WACN,IAAMC,EAASC,SAASC,eAAe,WACnCF,IACAA,EAAOG,UAAYH,EAAOI,gBAC/B,CAACxD,IACJmD,qBAAU,WACFN,GACAA,EAAOY,KAAK,cAEjB,CAACZ,IACJM,qBAAU,WACN,GAAKN,EAiBLA,EAAOa,GAAG,WAAW,WACjBC,aAAY,WACRd,EAAOY,KAAK,aAxEV,KA0ENZ,EAAOa,GAAG,eAAe,SAACE,EAA2CC,EAAwBC,GAC3E,MAAVD,GAAiBD,IACjB/B,EAAY+B,GAjBxB,SAAcG,GAAiC,IAAD,EACtCC,EAAcpC,EAElB,GADImC,IAAaC,EAAcD,GAC1BC,EAAL,CACA,IAEgB,EAFVC,IAAQ,IAAIC,MAAOC,UAAYH,EAAYI,OAAS,IAC3CC,KAAKC,IAAIL,GAAI,UAAG3B,EAAUiC,eAAb,aAAG,EAAmBN,SACrC,IACT,UAAA3B,EAAUiC,eAAV,SAAmBN,KAAKA,KAWpBO,CAAKZ,GACL7B,GAAa,IAEb+B,IACKhC,IAAqB,OAARF,QAAQ,IAARA,OAAA,EAAAA,EAAU6C,KAAKnE,MAAOwD,EAAYW,KAAKnE,IACrDuB,EAAYiC,IAGpB3B,EAAgB0B,MAEpBhB,EAAOa,GAAG,WAAW,SAAC1D,GAClB+C,EAAS/C,aAnCjB,CACI,IAAM6C,EAAS6B,aAAG,6BAClB5B,EAAUD,MAoCf,CAACjB,EAAUE,EAAWe,IA+CrB,sBACI8B,QAnBR,WACgC,IAAD,GAAtBvC,GAAcJ,IACf,UAAAM,EAAUiC,eAAV,SAAmBK,QAEvBvC,GAAc,IAgBV9B,UAAU,8DAFd,UAII,eAACsE,EAAA,EAAD,CAAOC,KAAMrC,EAAiBsC,UAAQ,EAACC,OAAQ,kBAAMtC,GAAmB,IAAxE,UACI,cAACmC,EAAA,EAAMI,OAAP,iCACA,eAACJ,EAAA,EAAMK,KAAP,WACI,cAACnE,EAAA,EAAKoE,MAAN,CAAY5E,UAAU,OAAtB,SACI,cAACQ,EAAA,EAAKI,QAAN,CAAcI,YAAY,OAAOH,MAAOlB,EAAMmB,SAAU,SAAAJ,GAAC,OAAIuB,EAAQvB,EAAEK,OAAOF,YAElF,cAACL,EAAA,EAAKoE,MAAN,CAAY5E,UAAU,OAAtB,SACI,cAACiB,EAAA,EAAD,CAAQmD,QAASzB,GAAiBxB,KAAK,SAAvC,0BAKZ,eAACmD,EAAA,EAAD,CAAOC,KAAMnC,EAAiBoC,UAAQ,EAACC,OAAQ,kBAAMpC,GAAmB,IAAxE,UACI,cAACiC,EAAA,EAAMI,OAAP,uBACA,cAACJ,EAAA,EAAMK,KAAP,UACI,cAACnF,EAAD,CAASG,KAAMA,EAAMF,MAAOA,EAAOC,YAhEnD,SAAqBG,GACjB,GAAKyC,GAAW3C,EAAhB,CAEA,IAAMS,EAAa,CACfP,UACAQ,OAAQV,EACRI,GAAI8E,cACJtE,MAAM,IAAIoD,MAAOmB,kBAErBxC,EAAOY,KAAK,WAAY9C,YA0DnBiB,GACG,cAAC,IAAD,CACIoB,OAAQA,EAAO,IACfsC,IAAK1D,EAAS6C,KAAKc,IACnBC,IAAKlD,EACLmD,QAAS3D,EACT4D,OA5DhB,WACIzD,GAAU,IA4DE0D,OApDhB,WACItD,GAAc,GACdN,GAAa,IAmDD6D,MA1DhB,WACI7D,GAAa,GACbE,GAAU,MA2DN,sBAAK1B,UAAU,cAAf,UACI,qBAAKA,UAAU,KAAf,kCAGCuB,GAAaM,GACV,sBAAK7B,UAAU,GAAf,wCACyBqB,QADzB,IACyBA,OADzB,EACyBA,EAAU6C,KAAKvE,QAG3C8B,IAAWI,GACR,qBAAK7B,UAAU,GAAf,mDAIc,MAAjB2B,GAAwBE,GACzB,qBAAK7B,UAAU,GAAf,wCAIEyB,GACF,qBAAKzB,UAAU,gCAAgCsF,KAAK,WAEpD,uBAAOzE,MAAO4B,EAAQ3B,SAAU,SAAAJ,GAAC,OAAGgC,GAAU6C,SAAS7E,EAAEK,OAAOF,SAAS2E,KAAM,EAAGC,IAAK,EAAGC,IAAK,IAAK1F,UAAU,aAAamB,KAAK,UAChI,uBACA,sBAAKnB,UAAU,oDAAf,UACKP,EAAMkG,OAAS,GAChB,gCAAMlG,EAAMA,EAAMkG,OAAS,GAAGtF,OAA9B,SAA2C,8BAAIZ,EAAMA,EAAMkG,OAAS,GAAG9F,QAAQ+F,MAAM,EAAG,IAAKnG,EAAMA,EAAMkG,OAAS,GAAG9F,QAAQ8F,OAAS,IAAM,YAE5I,qBAAKE,IAAI,OAAO7F,UAAU,WAAWoE,QAASzB,GACzCoC,IAAI,6ECpMde,MAVf,WACI,OACI,qBAAK9F,UAAU,OAAf,SACI,qBAAKA,UAAU,YAAf,SACI,cAACoB,EAAD,SCOD2E,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCDdQ,IAASC,OACL,cAAC,IAAMC,WAAP,UACI,cAAC,EAAD,MAEJ5D,SAASC,eAAe,SAM5BgD,K","file":"static/js/main.82370c3c.chunk.js","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\";\nimport ReactHowler from \"react-howler\";\nimport {io, Socket} from 'socket.io-client';\nimport CurrentlyPlaying from \"../interfaces/currentlyPlaying\";\nimport {DefaultEventsMap} from \"socket.io-client/build/typed-events\";\nimport {Button, Form, Modal} from \"react-bootstrap\";\nimport {Chat} from \"../interfaces/Chat\";\nimport {v4} from 'uuid';\n\nconst SYNC_RATE = 2000;\n\nfunction ChatBox({chats, sendMessage, name}: { chats: Chat[], sendMessage: (message: string) => void, name: string }) {\n    const [message, setMessage] = useState(\"\");\n    return <div>\n        <div id=\"chatBox\" className=\"overflow-auto my-3 p-2\" style={{maxHeight: \"60vh\"}}>\n            {chats.map(chat => <div className={\"my-3 \" + (chat.sender === name ? \"text-end\" : \"text-start\")}\n                                    key={chat.id}>\n                <div style={{wordBreak: \"break-all\"}}>{chat.message}</div>\n                <small className=\"fw-light\">{chat.sender} | {chat.time}</small>\n                <hr/>\n            </div>)}\n        </div>\n\n        <Form onSubmit={(e) => {\n            e.preventDefault();\n            if(message===\"\")return;\n            setMessage(\"\");\n            sendMessage(message)\n        }} className=\"d-flex\">\n            <Form.Control className=\"me-2\" value={message} onChange={e => setMessage(e.target.value)}\n                          placeholder=\"Write a message\"/>\n            <Button disabled={message===\"\"} type=\"submit\">Send</Button>\n        </Form>\n\n    </div>\n}\n\n\nexport default function Player() {\n    const [currSong, setCurrSong] = useState<CurrentlyPlaying>();\n    const [isPlaying, setIsPlaying] = useState(false);\n    const [loaded, setLoaded] = useState(false);\n    const [currentState, setCurrentState] = useState<\"X\" | \"W\" | \"P\">(\"X\");\n    const [interacted, setInteracted] = useState(false);\n    const playerRef: any = useRef(null);\n    const [name, setName] = useState<string>(\"\");\n    const [isNameModalOpen, setIsNameModalOpen] = useState(false);\n    const [isChatModalOpen, setIsChatModalOpen] = useState(false);\n    const [socket, setSocket] = useState<Socket<DefaultEventsMap, DefaultEventsMap>>();\n    const [chats, setChats] = useState<Chat[]>([]);\n    const [volume,setVolume]=useState(100);\n    useEffect(() => {\n        const boxRef = document.getElementById(\"chatBox\");\n        if (boxRef)\n            boxRef.scrollTop = boxRef.scrollHeight;\n    }, [chats])\n    useEffect(() => {\n        if (socket) {\n            socket.emit(\"getChats\");\n        }\n    }, [socket])\n    useEffect(() => {\n        if (!socket) {\n            const socket = io(\"http://34.131.157.38:3001\");\n            setSocket(socket);\n            return;\n        }\n\n        function sync(currSongArg?: CurrentlyPlaying) {\n            let currentSong = currSong;\n            if (currSongArg) currentSong = currSongArg;\n            if (!currentSong) return;\n            const seek = (new Date().getTime() - currentSong.start) / 1000;\n            const offset = Math.abs(seek - playerRef.current?.seek());\n            if (offset > 1) {\n                playerRef.current?.seek(seek);\n            }\n        }\n\n        socket.on(\"connect\", () => {\n            setInterval(() => {\n                socket.emit(\"askSong\")\n            }, SYNC_RATE)\n            socket.on(\"receiveSong\", (currentlyPlaying: CurrentlyPlaying | null, state: \"W\" | \"P\" | \"X\", nextPlaying: CurrentlyPlaying | null) => {\n                if (state === \"P\" && currentlyPlaying) {\n                    setCurrSong(currentlyPlaying);\n                    sync(currentlyPlaying)\n                    setIsPlaying(true);\n                }\n                if (nextPlaying) {\n                    if (!isPlaying && currSong?.song.id !== nextPlaying.song.id) {\n                        setCurrSong(nextPlaying);\n                    }\n                }\n                setCurrentState(state);\n            })\n            socket.on(\"newChat\", (chats: Chat[]) => {\n                setChats(chats);\n            })\n        })\n    }, [currSong, isPlaying, socket])\n\n    function sendMessage(message: string) {\n        if (!socket || !name) return;\n\n        const chat: Chat = {\n            message,\n            sender: name,\n            id: v4(),\n            time: new Date().toLocaleString()\n        }\n        socket.emit(\"sendChat\", chat)\n\n    }\n\n    function handleSongLoad() {\n        setLoaded(true);\n    }\n\n    function handleSongEnd() {\n        setIsPlaying(false);\n        setLoaded(false);\n    }\n\n    function handleSongPlay() {\n        setInteracted(true);\n        setIsPlaying(true);\n    }\n\n    function handleDivClick() {\n        if (!interacted && loaded) {\n            playerRef.current?.play();\n        }\n        setInteracted(true);\n    }\n\n    function handleChatClick() {\n        if (name !== \"\") {\n            setIsChatModalOpen(true);\n            setIsNameModalOpen(false);\n        } else {\n            setIsNameModalOpen(true);\n            setIsChatModalOpen(false);\n        }\n    }\n\n    return (\n        <div\n            onClick={handleDivClick}\n            className=\"d-flex min-vh-100 align-items-center justify-content-center\"\n        >\n            <Modal show={isNameModalOpen} centered onHide={() => setIsNameModalOpen(false)}>\n                <Modal.Header>Enter Name to Chat</Modal.Header>\n                <Modal.Body>\n                    <Form.Group className=\"mb-3\">\n                        <Form.Control placeholder=\"Name\" value={name} onChange={e => setName(e.target.value)}/>\n                    </Form.Group>\n                    <Form.Group className=\"mt-3\">\n                        <Button onClick={handleChatClick} type=\"submit\">Chat</Button>\n                    </Form.Group>\n\n                </Modal.Body>\n            </Modal>\n            <Modal show={isChatModalOpen} centered onHide={() => setIsChatModalOpen(false)}>\n                <Modal.Header>Messages</Modal.Header>\n                <Modal.Body>\n                    <ChatBox name={name} chats={chats} sendMessage={sendMessage}/>\n                </Modal.Body>\n            </Modal>\n            {currSong && (\n                <ReactHowler\n                    volume={volume/100}\n                    src={currSong.song.url}\n                    ref={playerRef}\n                    playing={isPlaying}\n                    onLoad={handleSongLoad}\n                    onPlay={handleSongPlay}\n                    onEnd={handleSongEnd}\n                />\n            )}\n            <div className=\"centre-card\">\n                <div className=\"h3\">\n                    Abhinay's LoFi Radio\n                </div>\n                {isPlaying && interacted && (\n                    <div className=\"\">\n                        Currently Playing : {currSong?.song.name}\n                    </div>\n                )}\n                {loaded && !interacted && (\n                    <div className=\"\">\n                        Click anywhere to start the playback!\n                    </div>\n                )}\n                {currentState === \"W\" && interacted &&\n                <div className=\"\">\n                    Waiting for the next song\n                </div>\n                }\n                {!loaded &&\n                <div className=\"spinner-border text-light m-3\" role=\"status\"/>\n                }\n                <input value={volume} onChange={e=> setVolume(parseInt(e.target.value))} step={1} min={1} max={100} className=\"form-range\" type=\"range\"/>\n                <hr/>\n                <div className=\"d-flex justify-content-between align-items-center\">\n                    {chats.length > 0 &&\n                    <div>{chats[chats.length - 1].sender} says <i>{chats[chats.length - 1].message.slice(0, 20)}{chats[chats.length - 1].message.length > 20 && \"...\"}</i>\n                    </div>}\n                    <img alt=\"chat\" className=\"ms-2 poh\" onClick={handleChatClick}\n                         src=\"https://img.icons8.com/material-outlined/24/000000/chat--v1.png\"/>\n                </div>\n            </div>\n        </div>\n    );\n}\n","import React from \"react\";\nimport \"./App.css\";\nimport Player from \"./pages/player\";\nfunction App() {\n    return (\n        <div className=\"App \">\n            <div className=\"container\">\n                <Player />\n            </div>\n        </div>\n    );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'bootstrap/dist/js/bootstrap.min';\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}